<div class='container'>
  <% if user_signed_in? %>
		<% if current_user.nickname == 'ゲスト' %>
	    <div class="text-center mt-4 mb-2">
				Sign up
				<%= link_to "here", users_guest_sign_out_path, method: :post %>
			</div>
	  <% end %>
  <% end %>
  <div class='row'>
    <div class='col-6 col-md-3 mt-5'>
			<div>
				<%= render 'games/info', game: @game %>
			</div>
		</div>

		<div class='col-md-9 mt-5'>
    	<div class="my-3">
    		<div class="h2 mr-2">Review</div>
				<div class="ml-2">
					<%= link_to '< Reviews List >', game_reviews_path(@review.game, @review), class: 'text-dark' %>
				</div>

  			<table class='table table-hover mt-3'>
  				<thead class="bg-light">
  					<tr>
  						<th></th>
  						<th>Nickname</th>
  						<th>Review</th>
  						<th>Useful</th>
  						<% if admin_signed_in? %>
  						  <th></th>
  						<% end %>
  					</tr>
  				</thead>

  				<tbody>
  				  <tr>
  				    <td>
  				      <%= link_to user_path(@review.user.id) do %>
  				        <%= image_tag @review.user.get_profile_image, size: "100x100", alt: 'user image' %>
  				      <% end %>
  				    </td>
  				    <td class="align-middle">
  				      <div class="ml-3">
  				        <%= link_to @review.user.nickname, user_path(@review.user.id), class: 'text-dark' %>
  				      </div>
  				    </td>
  				    <td class="align-middle">
  				      <div class="ml-3 table-text">
  				        <%= safe_join(@review.content.split("\n"),tag(:br)) %>
  				      </div>
  				    </td>
  				    <td class="align-middle", id="useful_buttons_<%= @review.id %>">
  				      <div class="ml-3">
  				        <%= render 'usefuls/btn', review: @review %>
  				      </div>
  				    </td>
  				    <% if admin_signed_in? %>
  				      <td class="align-middle">
                  <div class="ml-3">
                    <%= button_to 'Delete', game_review_path(@game, @review), method: :delete,
                        data: { confirm: 'Are you sure you want to delete this review ?' }, class: "btn btn-dark" %>
                  </div>
                </td>
              <% end %>
  				  </tr>
  				</tbody>
				</table>
			</div>

			<div class="my-3">
  		  <span class="h2 mr-2">Comments List</span> <span>(全<%= @review.comments.count %>件)</span>
        <div class="mt-3 ml-4">
          <%= render 'comments/index', comments: @comments %>
        </div>
        <% if user_signed_in? %>
          <% if current_user.nickname != 'ゲスト' %>
            <div class="ml-4">
              <%= render 'comments/form', game: @game, review: @review, comment: @comment %>
            </div>
          <% end %>
        <% end %>

        <div class="d-flex justify-content-center">
        	<p>
        		<%= paginate @comments, theme: 'bootstrap-5' %>
        	</p>
        </div>
      </div>
    </div>
  </div>
</div>
